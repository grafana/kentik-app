{"version":3,"sources":["../../src/components/device_details.js"],"names":[],"mappings":"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","file":"device_details.js","sourcesContent":["import _ from 'lodash';\n\nexport class DeviceDetailsCtrl {\n\n\t/** @ngInject */\n  constructor($scope, $injector, $location, backendSrv, alertSrv) {\n    this.backendSrv = backendSrv;\n    this.alertSrv = alertSrv;\n    this.$location = $location;\n    this.device = {};\n    this.deviceDTO = {};\n    this.pageReady = false;\n    this.getDevice($location.search().device);\n  }\n\n  addIP() {\n    this.other_ips.push({ip: ''});\n  }\n\n  removeIP(index) {\n    this.other_ips.splice(index, 1);\n  }\n\n  getDevice(deviceId) {\n    var self = this;\n    this.backendSrv.get(\"/api/plugin-proxy/kentik-app/api/v1/device/\"+deviceId).then(function(resp) {\n      self.device = resp.device[0];\n      self.updateDeviceDTO();\n      self.pageReady = true;\n    });\n  }\n\n  gotoDashboard(device_name) {\n    this.$location.url(\"/dashboard/db/kentik-top-talkers?var-device=\"+device_name);\n  }\n\n  updateDeviceDTO() {\n    var self = this;\n    this.deviceDTO = {\n      device_id: this.device.id,\n      device_name: this.device.device_name,\n      type: this.device.device_type,\n      device_description: this.device.device_description,\n      flow_type: this.device.device_flow_type,\n      flow_rate: parseInt(this.device.device_sample_rate),\n      other_ips: this.device.device_chf_interface,\n      minimize_snmp: this.device.minimize_snmp,\n      device_ip: this.device.device_snmp_ip,\n      snmp_community: this.device.device_snmp_community,\n    };\n    this.other_ips = [];\n    _.forEach(this.deviceDTO.other_ips.split(','), function(ip) {\n      self.other_ips.push({ip: ip});\n    });\n  }\n\n  update() {\n    var self = this;\n    var ips = [];\n    _.forEach(this.other_ips, function(ip) {\n      ips.push(ip.ip);\n    });\n    if (!this.deviceDTO.device_ip) {\n      delete this.deviceDTO.device_ip;\n    }\n    if (!this.deviceDTO.snmp_community) {\n      delete this.deviceDTO.snmp_community;\n    }\n\n    this.deviceDTO.other_ips = ips.join();\n    this.backendSrv.post(\"/api/plugin-proxy/kentik-app/api/v1/device/\"+this.deviceDTO.device_id, this.deviceDTO).then((resp) => {\n      if ('err' in resp) {\n        this.alertSrv.set(\"Device Update failed.\", resp.err, 'error');\n      } else {\n        return self.getDevice(self.deviceDTO.device_id);\n      }\n    });\n  }\n}\n\nDeviceDetailsCtrl.templateUrl = 'components/device_details.html';\n"]}